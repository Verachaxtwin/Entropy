# Entropy
#cs _CalculateBitEntropy Name: _CalculateBitEntropy Description: Calculate the bit entropy of a string. Author: dany Parameters: $sStr - String: String to evaluate. $fCase - Boolean: Do case-sensitive evaluation, default true. Return values: Success: - Float: Bit entropy. Failure: - 0 and sets @error Link: http://en.wikipedia.org/wiki/Password_strength#Entropy_as_a_measure_of_password_strength #ce Func _CalculateBitEntropy($sStr, $fCase = True) If IsBinary($sStr) Then $sStr = BinaryToString($sStr) If Not IsString($sStr) Then Return SetError(1, 0, 0) Local $aDice, $iH = 0, $iLen = StringLen($sStr) If 0 = $iLen Then Return SetError(2, 0, 0) $aDice = StringSplit($sStr, ' ') If 1 &lt; $aDice[0] And StringRegExp($sStr, '^[[:alnum:] ]+$') Then Return $aDice[0] * 12.925 If StringIsDigit($sStr) Then $iH = 3.3219 ElseIf StringIsXDigit($sStr) Then $iH = 4.0000 ElseIf StringIsAlpha($sStr) Then $iH = 4.7004 If $fCase Then If StringRegExp($sStr, '[[:lower:]]') And StringRegExp($sStr, '[[:upper:]]') Then $iH = 5.7004 EndIf ElseIf StringIsAlNum($sStr) Then $iH = 5.1699 If $fCase Then If StringRegExp($sStr, '[[:lower:]]') And StringRegExp($sStr, '[[:upper:]]') Then $iH = 5.9542 EndIf ElseIf StringRegExp($sStr, '^[^[:cntrl:]x7F]+$') Then $iH = 6.5699 ElseIf _StringRegExp($sStr, '^[^[:cntrl:]x7Fx81x8Dx8Fx90x9D]+$') Then $iH = 7.7682 EndIf Return $iH * $iLen EndFunc
